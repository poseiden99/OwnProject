=> customer
+-------------+---------+---------+
| customer_id | name    | country |
+-------------+---------+---------+
|     1       | Mohit   | India   |
|     2       | Raj     | India   |
|     3       | Darpan  | USA     |
|     4       | Vimal   | Aus     |
+-------------+---------+---------+


=> order
+------------+-------------+------------+--------+
| order_id   | customer_id | order_date | amount |
+------------+-------------+------------+--------+
| ORD-1001   |     1       | 2024-06-01 |  200   |
| ORD-1002   |     1       | 2024-07-01 |  150   |
| ORD-1003   |     1       | 2024-08-01 |  300   |
| ORD-1004   |     1       | 2024-09-01 |  250   |
| ORD-1005   |     1       | 2024-10-01 |  500   |
| ORD-1006   |     2       | 2024-07-15 |  300   |
| ORD-1007   |     5       | 2024-07-20 |  400   |
+------------+-------------+------------+--------+


=> expected output
+------------+-------------+------------+--------+-------------------------------------+
| order_id   | customer_id | order_date | amount | total_amount_spent_as_of_order_date |
+------------+-------------+------------+--------+-------------------------------------+
| ORD-1001   |     1       | 2024-06-01 |  200   | 200                                 |
| ORD-1002   |     1       | 2024-07-01 |  150   | 350                                 |
| ORD-1003   |     1       | 2024-08-01 |  300   | 650                                 |
| ORD-1004   |     1       | 2024-09-01 |  250   | 900                                 |
| ORD-1005   |     1       | 2024-10-01 |  500   | 1400                                |
| ORD-1006   |     2       | 2024-07-15 |  300   | 300                                 |
| ORD-1007   |     5       | 2024-07-20 |  400   | 400                                 |
+------------+-------------+------------+--------+-------------------------------------+

=> expected-output
+-------------+---------+--------------+
| customer_id | name    | total_amount |
+-------------+---------+--------------+
|     1       | Alice   |     350      |
|     2       | Bob     |     300      |
|     3       | Charlie |     NULL     |
|     4       | Dave    |     NULL     |
+-------------+---------+--------------+